# vktech
  Сервис создавался для участия в конкурсе [https://vk.com/wall-147415323_957](VK Tech).
  Вся инфраструктура расположена на серверах, предоставленных компанией [https://digitalocean.com](DigitalOcean) (DO)
  За время конкурса я успел разработать следующую архитектуру сервиса:
  * DNS-balancer
  * Front server (x2)
  * Backend server (x2)
  * Mysql server (x2)
  * Memcached server (x2)
  * Worker server (x2)
### **DNS-balancer**
  Взят у DO в аренду и равномерно распределяет по доступным **front** серверам запросы к [execordervk.tech](execordervk.tech) по принципу Round Robin. Предпочёл отказаться от двух A-записей в пользу DNS балансера дабы не возникало проблем при отключении одного из **front** серверов, у которых закеширована A-запись этого сервера.
### **Front**
  2 сервера с установленными на них nginx, в конфиге которых прописан редирект всех .php запросов на upstream из двух **backend** серверов, а вся статика отдаётся с самого **front**
  На каждом сервере настроен https (все http запросы перенаправляются на https). Сертификаты получены на доменное имя execordervk.tech при помощи **cretbot**
  Открыты 22, 80, 443 порты.
### **Backend**
  2 сервера с установленными apache2 + php7.0, php7.0-mysql, php7.0-json, php-memcached, libapache2-mod-php7.0.
  Открыты 22, 80, 443 порты.
### **Mysql**
  2 сервера с настроенной репликацией Master + Slave
  Открыты 22, 3306 порты.
### **Memcached**
  2 сервера с установленным memcached.
  Открыт 22 порт для всех и 11211 для 4 ip адресов (2x**backend**, 2x**worker**).
### **Worker**
  2 сервера для медленных или регулярных задач.
